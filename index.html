<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Lista de Sa√≠das</title>

  <!-- Meta PWA -->
  <meta name="theme-color" content="#0b1220"/>
  <link rel="manifest" href="manifest.json">

  <!-- √çcone (Necess√°rio para o 'Add to Home Screen') -->
  <link rel="apple-touch-icon" href="https://placehold.co/192x192/0b1220/ffffff?text=App">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

  <!-- Refer√™ncia ao CSS externo -->
  <link rel="stylesheet" href="style.css">

  <!-- no-flash theme (dark forced) -->
  <script>
    (function() {
      document.documentElement.classList.add("dark");
      document.documentElement.style.opacity = "0";
    })();
  </script>

  <!-- Tailwind CDN (Mantido, pois o app.js n√£o o importa) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: { inter: ['Inter', 'system-ui', 'ui-sans-serif']},
          colors: {
            brand: {
              DEFAULT: '#2563eb',
              dark: '#1d4ed8'
            }
          },
          boxShadow: {
            soft: '0 10px 25px -10px rgba(0,0,0,.25)'
          }
        }
      }
    }
  </script>

</head>
<body class="font-inter bg-slate-100 dark:bg-slate-900 text-slate-800 dark:text-slate-100 transition-colors duration-300">

  <!-- O HTML da aplica√ß√£o permanece o mesmo -->
  <div id="login-overlay" class="fixed inset-0 z-50 hidden items-center justify-center bg-black/60 p-4">
    <!-- ... (todo o conte√∫do do login overlay) ... -->
    <div class="w-full max-w-md rounded-2xl bg-white dark:bg-slate-800 shadow-soft p-6">
      <div class="flex items-center gap-3 mb-4">
        <h2 class="text-xl font-extrabold">Acesso</h2>
      </div>
      <p class="text-sm opacity-80 mb-4">Entre com usu√°rio e PIN.</p>
      <div class="grid gap-3">
        <input id="login-user" class="input" placeholder="Usu√°rio">
        <input id="login-pin" class="input" placeholder="PIN" type="password" inputmode="numeric">
        <button id="login-btn" class="btn-primary">Entrar</button>
      </div>
      <p id="login-msg" class="mt-3 text-sm text-red-500 hidden"></p>
    </div>
  </div>

  <div id="modal-overlay" class="fixed inset-0 z-50 hidden items-center justify-center bg-black/60 p-4">
    <!-- ... (todo o conte√∫do do modal gen√©rico) ... -->
    <div class="w-full max-w-md rounded-2xl bg-white dark:bg-slate-800 shadow-soft p-6">
      <div class="flex items-center justify-between mb-4">
        <h2 id="modal-title" class="text-xl font-extrabold">Editar</h2>
        <button id="modal-close" class="btn-icon">‚úñ</button>
      </div>
      <div id="modal-content" class="grid gap-3">
        <!-- Conte√∫do din√¢mico aqui --></div>
      <div class="mt-4 flex gap-2">
        <button id="modal-save" class="btn-primary flex-1">Salvar</button>
        <button id="modal-cancel" class="btn-secondary flex-1">Cancelar</button>
      </div>
    </div>
  </div>

  <div id="app" class="opacity-0">
    <header class="sticky top-0 z-40 backdrop-blur bg-white/70 dark:bg-slate-900/70 border-b border-slate-200/60 dark:border-slate-700/60">
      <!-- ... (todo o conte√∫do do header) ... -->
      <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <h1 class="text-lg sm:text-2xl font-black">Lista de Sa√≠das<span class="text-slate-400"></span></h1>
        </div>
        <div class="flex items-center gap-2">
          <span id="clock" class="hidden sm:inline font-mono text-sm opacity-80"></span>
          <button id="logout-btn" class="btn-ghost">Sair</button>
        </div>
      </div>
    </header>

    <main class="max-w-6xl mx-auto px-4 py-6 grid md:grid-cols-[280px,1fr] gap-6">
      <aside class="rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-4 space-y-4 h-fit md:sticky md:top-20">
        <!-- ... (todo o conte√∫do da sidebar) ... -->
        <h3 class="text-base font-extrabold">Navega√ß√£o</h3>
        <nav class="grid gap-2">
          <!-- Bot√µes de aba atualizados com √çcones SVG -->
          <button class="tab-btn active" data-tab="saidas">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" /></svg>
            Controle de Sa√≠das
          </button>
          <button class="tab-btn" data-tab="chat">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd" /></svg>
            Chat
          </button>
          <button class="tab-btn" data-tab="s5">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor"><path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" /><path fill-rule="evenodd" d="M4 5a2 2 0 012-2h8a2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h.01a1 1 0 100-2H10zm3 0a1 1 0 000 2h.01a1 1 0 100-2H13z" clip-rule="evenodd" /></svg>
            Gest√£o 5S
          </button>
          <button class="tab-btn" data-tab="config">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.835 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.835 2.942-.734 2.106-2.106a1.533 1.533 0 01-.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.835-1.372-.734-2.942-2.106-2.106A1.532 1.532 0 0111.49 3.17zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" /></svg>
            Configura√ß√µes
          </button>
        </nav>
        <div class="rounded-xl bg-emerald-50 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300 p-3 text-sm">
          <b>Status:</b> <span id="status-conn">Conectado</span> <span class="opacity-70">(Nuvem)</span>
        </div>
        <div>
          <button id="ddm-header" class="w-full flex items-center justify-between rounded-xl bg-slate-50 dark:bg-slate-700/40 px-3 py-2 text-sm font-bold">
            Gerenciar Dados <span class="transition-transform" id="ddm-caret">‚ñº</span>
          </button>
          <div id="ddm" class="mt-3 grid gap-2 hidden">
            <button id="btn-backup-download" class="btn-secondary">Baixar Backup Completo (.json)</button>
            <label class="btn-secondary cursor-pointer text-center">
              <input id="file-backup" type="file" accept="application/json" class="hidden">
              Carregar Backup Completo (.json)
            </label>
            <button id="btn-reset" class="btn-danger">Resetar TUDO (Nuvem)</button>
          </div>
        </div>
      </aside>

      <section class="space-y-6">
        <div id="tab-saidas" class="card">
          <!-- ... (todo o conte√∫do da tab saidas) ... -->
          <div class="flex items-center justify-between gap-4">
            <div>
              <h2 class="text-xl font-bold">Painel de Controle</h2>
              <p class="text-sm opacity-70">Hor√°rio de Bras√≠lia</p>
            </div>
            <div id="alarm-pill" class="px-3 py-1 rounded-full text-xs font-black bg-emerald-200 text-emerald-800 dark:bg-emerald-800 dark:text-emerald-200 cursor-pointer transition-colors" title="Clique para ligar/desligar o alarme sonoro">ALARME: LIGADO</div>
          </div>
          <div class="mt-6">
            <h3 class="section-title">Adicionar Aluno √† Fila de Espera</h3>
            <div class="flex gap-2">
              <input id="input-name" class="input flex-1" placeholder="Nome completo do aluno (ex: Allanna Leite Teixeira)">
              <button id="btn-add" class="btn-primary">Adicionar √† Fila</button>
            </div>
          </div>
          <div class="mt-8">
            <div class="flex items-center justify-between">
              <h3 class="section-title">Fila de Sa√≠da & Retorno <span id="pending-count" class="badge">0</span></h3>
              <input id="hist-search" class="input w-56" placeholder="üîé Filtrar hist√≥rico...">
            </div>
            <div class="flex gap-2 mt-4" id="fila-filter-buttons">
                <button class="btn-primary active px-4" data-fila-filter="todos">Todos</button>
                <button class="btn-secondary px-4" data-fila-filter="pendentes">Pendentes</button>
                <button class="btn-secondary px-4" data-fila-filter="liberados">Liberados</button>
            </div>
            <ul id="pending-list" class="mt-3 grid gap-3"></ul>
          </div>
          <div class="mt-8">
            <h3 class="section-title">Hist√≥rico</h3>
            <div id="history" class="mt-3 grid gap-2"></div>
          </div>
        </div>

        <div id="tab-chat" class="card hidden">
          <!-- ... (todo o conte√∫do da tab chat) ... -->
           <div class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-bold">Chat Interno</h2>
            <button id="chat-clear-btn" class="btn-danger btn-icon" title="Limpar todo o hist√≥rico do chat">üóë</button>
          </div>
          <div id="chat-box" class="h-64 overflow-y-auto border border-slate-200 dark:border-slate-700 rounded-lg p-3 mb-4 space-y-3">
            <p class="text-sm opacity-70 italic">Carregando mensagens...</p>
          </div>
          <div class="flex gap-2">
            <input id="chat-input" class="input flex-1" placeholder="Digite sua mensagem...">
            <button id="chat-send" class="btn-primary px-5">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009.175 17V4.609a1 1 0 00-1.447-.894l-5 1.428zM10.894 2.553l7 14a1 1 0 001.169-1.409l-5-1.429A1 1 0 0013.825 17V4.609a1 1 0 00-1.447-.894l5 1.428z" /></svg>
            </button>
          </div>
        </div>

        <div id="tab-s5" class="card hidden">
          <!-- ... (todo o conte√∫do da tab 5S) ... -->
          <h2 class="text-xl font-bold mb-4 text-center">Gest√£o de Qualidade 5S</h2>
          <div class="grid sm:grid-cols-2 gap-3">
            <input id="s5-p1" class="input" placeholder="Pessoa 1">
            <input id="s5-p2" class="input" placeholder="Pessoa 2">
            <input id="s5-p3" class="input" placeholder="Pessoa 3">
            <input id="s5-p4" class="input" placeholder="Pessoa 4">
            <select id="s5-shift" class="input"><option>Manh√£</option><option>Tarde</option><option>Noite</option></select>
            <textarea id="s5-notes" class="input sm:col-span-2" rows="2" placeholder="Observa√ß√µes (opcional)"></textarea>
            <button id="s5-add" class="btn-primary sm:col-span-2">Adicionar Equipe</button>
          </div>
          <ul id="s5-list" class="mt-6 grid gap-2"></ul>
        </div>

        <div id="tab-config" class="card hidden">
          <!-- ... (todo o conte√∫do da tab config) ... -->
          <h2 class="text-xl font-bold mb-4 text-center">Configura√ß√µes</h2>
          <div class="grid sm:grid-cols-2 gap-4">
            <div class="field">
              <label>1¬∫ Alerta (min)</label><input id="al1" type="number" class="input" min="1">
            </div>
            <div class="field">
              <label>2¬∫ Alerta (min)</label><input id="al2" type="number" class="input" min="1">
            </div>
            <div class="field">
              <label>3¬∫ Alerta (min)</label><input id="al3" type="number" class="input" min="1">
            </div>
            <div class="field">
              <label>4¬∫ Alerta (min)</label><input id="al4" type="number" class="input" min="1">
            </div>
            <div class="field sm:col-span-2">
              <label>Alarme Cont√≠nuo (min)</label><input id="alP" type="number" class="input" min="1">
            </div>
            <div class="field sm:col-span-2">
              <label>Motivo Padr√£o</label><input id="def-reason" class="input">
            </div>
            <div class="field sm:col-span-2">
              <label>Motivos Comuns (separados por ; )</label>
              <textarea id="conf-reasons" class="input" rows="3" placeholder="Ex: Banheiro;Beber √Ågua;Secretaria;Outro"></textarea>
            </div>
            <button id="btn-save-settings" class="btn-primary sm:col-span-2">Salvar Configura√ß√µes</button>
          </div>
        </div>
      </section>
    </main>

    <div id="toast" class="fixed bottom-4 right-4 hidden"></div>

  </div>

  <script>
    // Reveal after JS initialization starts
    window.addEventListener('load', () => {
      document.documentElement.style.opacity = "1";
      document.getElementById('app').classList.remove('opacity-0');

      // (Novo) Service Worker Registration
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js')
          .then((registration) => {
            console.log('Service Worker registrado com sucesso:', registration.scope);
          })
          .catch((error) => {
            console.error('Falha ao registrar Service Worker:', error);
          });
      }
    });
  </script>

  <!-- Refer√™ncia ao JS externo -->
  <script src="app.js" type="module"></script>

</body>
</html>

